{% extends 'main/base.html' %}

{% block title %}–ú—ñ–π –∫–ª–∞—Å{% endblock %}

{% block content %}

<h2 class="mb-4">üë©‚Äçüè´ –ú—ñ–π –∫–ª–∞—Å {{ class_obj.name }} </h2>

{% if not_class_teacher %}

<div class="alert alert-warning">–í–∏ –Ω–µ —î –∫–ª–∞—Å–Ω–∏–º –∫–µ—Ä—ñ–≤–Ω–∏–∫–æ–º –∂–æ–¥–Ω–æ–≥–æ –∫–ª–∞—Å—É.</div>
{% else %}
<ul class="nav nav-tabs" id="myTab" role="tablist">
  <li class="nav-item" role="presentation">
    <button class="nav-link active" id="students-tab" data-bs-toggle="tab" data-bs-target="#students" type="button"
      role="tab">–£—á–Ω—ñ</button>
  </li>
  <li class="nav-item" role="presentation">
    <button class="nav-link" id="stats-tab" data-bs-toggle="tab" data-bs-target="#stats" type="button"
      role="tab">–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</button>
  </li>
</ul>

<div class="tab-content pt-3">
  <!-- –í–∫–ª–∞–¥–∫–∞ "–£—á–Ω—ñ" -->
  <div class="tab-pane fade show active" id="students" role="tabpanel">
    <h5>–ö–ª–∞—Å: {{ class_obj.name }}</h5>
    <ol class="list-group list-group-numbered">
      {% for student in students %}
      <li class="list-group-item d-flex align-items-center">
        {% if student.photo.url %}
        <img src="{{ student.photo.url }}" alt="avatar" class="rounded-circle me-3"
          style="width:40px; height:40px; object-fit: cover;">
        {% else %}
        <div class="bg-secondary rounded-circle me-3" style="width:40px; height:40px;"></div>
        {% endif %}
        <div>
          <strong>{{ student.full_name }}</strong><br>
          <small class="text-muted">{{ student.email }}</small>
        </div>
      </li>
      {% empty %}
      <li class="list-group-item">–£ –∫–ª–∞—Å—ñ —â–µ –Ω–µ–º–∞—î —É—á–Ω—ñ–≤.</li>
      {% endfor %}
    </ol>
  </div>

<!-- –í–∫–ª–∞–¥–∫–∞ "–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞" -->
<div class="tab-pane fade" id="stats" role="tabpanel">
  <h5>üìä –°–µ—Ä–µ–¥–Ω—ñ–π –±–∞–ª —É—á–Ω—ñ–≤ (–≤—ñ–¥ –±—ñ–ª—å—à–æ–≥–æ –¥–æ –º–µ–Ω—à–æ–≥–æ)</h5>

  <!-- –°–ø–∏—Å–æ–∫ —É—á–µ–Ω–∏–∫–æ–≤ -->
  <ol class="list-group list-group-numbered">
    {% for entry in stats %}
    <li class="list-group-item d-flex justify-content-between align-items-center">
      <span class="text-start flex-grow-1">{{ entry.student__full_name }}</span>
      <strong class="text-end ms-3" style="min-width: 40px;">{{ entry.avg_grade|floatformat:2 }}</strong>
    </li>
    {% empty %}
    <li class="list-group-item">–ü–æ–∫–∏ —â–æ –Ω–µ–º–∞—î –æ—Ü—ñ–Ω–æ–∫ –¥–ª—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏.</li>
    {% endfor %}
  </ol>

  <!-- –ì—Ä–∞—Ñ–∏–∫ -->
  {% if stats_chart %}
  <div class="text-center mt-4">
    <img src="data:image/png;base64,{{ stats_chart }}" alt="–ì—Ä–∞—Ñ—ñ–∫ —Å–µ—Ä–µ–¥–Ω—ñ—Ö –±–∞–ª—ñ–≤" class="img-fluid" style="max-width: 100%;">
  </div>
{% endif %}


</div>



</div>
{% endif %}

{% endblock %}