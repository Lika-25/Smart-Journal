{% extends 'main/base.html' %}

{% block title %}
–ü—Ä–æ—Ñ—ñ–ª—å —É—á–Ω—è
{% endblock %}

{% block content %}
<h2 class="mb-4">–í—ñ—Ç–∞—î–º–æ, {{ student.full_name }}! üëã</h2>

<form method="post" enctype="multipart/form-data" action="{% url 'update_student_profile' %}">
  {% csrf_token %}
  <div class="mb-3">
    <label><strong>–ü–Ü–ë:</strong></label>
    <textarea name="full_name" class="form-control" id="fullNameInput" readonly rows="1" style="resize:none;">{{ student.full_name }}</textarea>
  </div>

  <div class="mb-3">
    <label><strong>Email:</strong></label>
    <textarea name="email" class="form-control" id="emailInput" readonly rows="1" style="resize:none;">{{ student.email }}</textarea>
  </div>

  <div class="mb-3">
    <label><strong>–ö–ª–∞—Å:</strong></label>
    <input type="text" value="{{ student.class_id.name }}" class="form-control" readonly>
  </div>

  {% if student.class_id.class_teacher %}
  <div class="mb-3">
    <label><strong>–ö–ª–∞—Å–Ω–∏–π –∫–µ—Ä—ñ–≤–Ω–∏–∫:</strong></label>
    <textarea class="form-control" readonly rows="1" style="resize:none;">{{ student.class_id.class_teacher.full_name }}</textarea>
  </div>
  {% endif %}

  <div class="mb-3">
    <label><strong>–ü—Ä–µ–¥–º–µ—Ç–∏, —è–∫—ñ –≤–∏ –≤–∏–≤—á–∞—î—Ç–µ:</strong></label>
    <ul>
      {% for subject in subjects %}
        <li>{{ subject.subject.name }}</li>
      {% empty %}
        <li>–ü—Ä–µ–¥–º–µ—Ç–∏ –Ω–µ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω—ñ</li>
      {% endfor %}
    </ul>
  </div>

  <div class="mb-3">
    <label><strong>–í–∞—à–µ —Ñ–æ—Ç–æ:</strong></label><br>
    {% if student.photo %}
      <img src="{{ student.photo.url }}" id="studentPhotoPreview" class="img-thumbnail mb-2" style="max-width: 200px;">
    {% endif %}
    <input type="file" name="photo" class="form-control" id="photoInput" disabled>
  </div>

  <button type="button" class="btn btn-secondary" id="editBtn">–†–µ–¥–∞–≥—É–≤–∞—Ç–∏</button>
  <button type="submit" class="btn btn-success d-none" id="saveBtn">–ó–±–µ—Ä–µ–≥—Ç–∏</button>
</form>

<script>
  document.getElementById('editBtn').addEventListener('click', function () {
    document.getElementById('fullNameInput').removeAttribute('readonly');
    document.getElementById('emailInput').removeAttribute('readonly');
    document.getElementById('photoInput').removeAttribute('disabled');
    document.getElementById('saveBtn').classList.remove('d-none');
    this.classList.add('d-none');
  });
</script>
{% endblock %}
